(function(){var t,e,o,a,i;void 0,void 0,void 0,void 0,a=void 0,i="https://checkout-form.herokuapp.com",e=function(){var t=document.currentScript||function(){var t=document.getElementsByTagName("script");return t[t.length-1]}();return""===t.id&&(t.id+="o_ch_"+(new Date).getTime()),t},t=function(){return!!(window.navigator.userAgent.indexOf("MSIE ")>0||navigator.userAgent.match(/Trident.*rv\:11\./))},o=function(e,o){var a,i;return i=document.querySelector(".octobat-checkout-frame"),void 0!==window.jQuery?(a=jQuery.Event(e),a.detail=o,$(i).trigger(a)):(t()?(a=document.createEvent("CustomEvent"),a.initCustomEvent(e,!0,!0,o)):a=new CustomEvent(e,{detail:o,bubbles:!0,cancelable:!0}),i.dispatchEvent(a))},OctobatCheckoutAppJS=function(){this.iframeLoaded=!1},OctobatCheckoutAppJS.prototype={bind:function(t,e,o){return t.addEventListener?t.addEventListener(e,o,!1):t.attachEvent("on"+e,o)},unbind:function(t,e,o){return t.removeEventListener?t.removeEventListener(e,o,!1):t.detachEvent("on"+e,o)},toURIparams:function(t){return"?"+Object.keys(t).reduce(function(e,o){return e.push(o+"="+encodeURIComponent(t[o])),e},[]).join("&")},scriptAttributes:function(t){return{octobat_pkey:a.scriptData("octobat-pkey",t),plan:a.scriptData("plan",t),charge:a.scriptData("charge",t),sku:a.scriptData("sku",t),taxes_included:a.scriptData("taxes",t),transaction_type:a.scriptData("transaction-type",t)||"eservice",gateway:a.scriptData("gateway",t),moss_compliance:a.scriptData("moss-compliance",t)||!0,validate_tax_number:a.scriptData("validate-tax-number",t)||!0,display_billing_address:a.scriptData("billing-address",t)||!1,coupon:a.scriptData("coupon",t)||!1,name:a.scriptData("name",t),email:a.scriptData("email",t),country:a.scriptData("country",t),street_line_1:a.scriptData("street-line-1",t),zip_code:a.scriptData("zip-code",t),city:a.scriptData("city",t),description:a.scriptData("description",t),supplier_name:a.scriptData("supplier-name",t),image:a.scriptData("image",t),script_id:t.id,octobat_checkout_id:a.scriptData("octobat-checkout-id",t),detailed_panel:a.scriptData("detailed-panel",t)||!1,quantity:parseInt(a.scriptData("quantity",t))||1}},scriptData:function(t,e){return e||(e=OctobatCheckout.currentScript()),e.getAttribute("data-"+t)},iframeHasLoaded:function(t){return void 0!==t&&(this.iframeLoaded=t),this.iframeLoaded}},OctobatCheckoutButtonJS=function(t){this._iframe=OctobatCheckout.iframe(),this._label=t||"Pay with card"},OctobatCheckoutButtonJS.prototype={render:function(){var t,e,o,i;0===document.querySelectorAll(".octobat-checkout-button-style").length&&(e=document.head,i=document.createElement("link"),i.type="text/css",i.rel="stylesheet",i.href="https://s3-eu-west-1.amazonaws.com/js.octobat.com/css/octobat-checkout-button.css",i.className="octobat-checkout-button-style",e.appendChild(i)),t=void 0,o=void 0,t=document.createElement("button"),t.className="octobat-checkout-button-el",o=document.createTextNode(this._label),t.appendChild(o),window.OctobatCheckout.currentForm().appendChild(t),window.OctobatCheckout.currentForm().addEventListener("submit",function(t){var e,o;return t.preventDefault(),o=this.getElementsByClassName("octobat-checkout-button")[0],e=a.scriptAttributes(o),a.iframeHasLoaded()?OctobatCheckout.iframe().toggle(e):(document.querySelector(".octobat-checkout-loader").style.display="block",document.querySelector(".octobat-checkout-frame").addEventListener("octobat.iframe.loaded",function(){return OctobatCheckout.iframe().toggle(e,!0)})),!1})}},OctobatCheckoutIFrameJS=function(t){var e;this.url=window.location.protocol+"//"+window.location.host+"/";for(e in t)this[e]=t[e]},OctobatCheckoutIFrameJS.prototype={_host:function(){return i+"/v2"},_attributes:function(){var t,e;e={};for(t in this)this.hasOwnProperty(t)&&null!==this[t]&&(e[t]=this[t]);return e},appendIframe:function(){var t,e;return 0===document.querySelectorAll(".octobat-checkout-frame").length?(t=void 0,e=void 0,e=document.createElement("iframe"),e.setAttribute("frameBorder","0"),e.setAttribute("allowtransparency","true"),t="z-index: 9999;\nbackground: transparent;\nbackground: rgba(0,0,0,0.005);\nvisibility: hidden;\nborder: 0px none transparent;\noverflow-x: hidden;\noverflow-y: auto;\nmargin: 0;\npadding: 0;\n-webkit-tap-highlight-color: transparent;\n-webkit-touch-callout: none;",t+="position: fixed;\nleft: 0;\ntop: 0;\nwidth: 0%;\nheight: 0%;",e.style.cssText=t,e.src=this._host()+a.toURIparams(this._attributes()),e.className=e.name="octobat-checkout-frame",document.body.appendChild(e),a.bind(e,"load",function(){var t,e;return a.iframeHasLoaded(!0),e="octobat.iframe.loaded",t=document.createEvent("Event"),t.initEvent(e,!0,!0),OctobatCheckout.iframe()._el.dispatchEvent(t)})):e=document.querySelector(".octobat-checkout-frame"),this._el=e,e},toggle:function(t,e){var o,c,n,r;null==e&&(e=!1),o=document.querySelector("body"),e||"0%"===this._el.style.height&&a.iframeHasLoaded()?(o.style.overflow="hidden",this._el.style.width="100%",this._el.style.height="100%",this._el.style.visibility="",n=document.querySelector(".octobat-checkout-loader"),n.style.display="none",this._el.contentWindow.postMessage(t,i),r=document.createElement("meta"),r.name="viewport",r.content="width=device-width, initial-scale=1.0, maximum-scale=1.0",document.getElementsByTagName("head")[0].appendChild(r)):(o.style.overflow="",this._el.style.width="0%",this._el.style.height="0%",this._el.style.visibility="hidden",c=document.getElementsByTagName("head")[0],r=c.lastChild,"viewport"===r.name&&"width=device-width, initial-scale=1.0, maximum-scale=1.0"===r.content&&c.removeChild(r))}},OctobatCheckoutJS=function(t){this.app=new OctobatCheckoutAppJS,this.currentScriptEl=t||e(),this.currentFormEl=this.currentScriptEl.parentNode,this.octobat_pkey="",this.callback={},this._iframe=null,this._button=null,this._loader=null},OctobatCheckoutJS.prototype={app:function(){return this.app},configure:function(t){var e,o;return this.octobat_pkey=t.octobat_pkey,this.callback=t.callback,0===document.querySelectorAll(".octobat-checkout-loader").length&&(this._loader=document.createElement("div"),this._loader.className="octobat-checkout-loader",this._loader.style.cssText="position:fixed;left:0;top:0;width:100%;height:100%;overflow-x:hidden;overflow-y:auto;z-index:9999;background:rgba(0,0,0,0.6);",this._loader.style.display="none",document.body.appendChild(this._loader),o=document.createElement("div"),o.style.cssText="margin:auto;position:absolute;top:0;left:0;bottom:0;right:0; width: 60px; height: 60px; background-color:#FFFFFF;border-radius: 60px;",this._loader.appendChild(o),e=document.createElement("img"),e.src="https://s3-eu-west-1.amazonaws.com/js.octobat.com/img/spiffygif_80x80.gif",e.style.cssText="margin:auto;position:absolute;top:0;left:0;bottom:0;right:0;height:54px;width:54px;",o.appendChild(e)),this},currentScript:function(t){return void 0!==t&&(this.currentScriptEl=t,this.currentFormEl=t.parentNode),this.currentScriptEl},currentForm:function(){return this.currentFormEl},iframe:function(){return this._iframe},pkey:function(){return this.octobat_pkey},open:function(t){t.key=this.octobat_pkey,null===this._iframe&&(this._iframe=new OctobatCheckoutIFrameJS({key:this.octobat_pkey}),this._iframe.appendIframe()),a.iframeHasLoaded()?this._iframe.toggle(t):(document.querySelector(".octobat-checkout-loader").style.display="block",this._iframe._el.addEventListener("octobat.iframe.loaded",function(){return OctobatCheckout._iframe.toggle(t)}))},close:function(){this._iframe instanceof OctobatCheckoutIFrameJS&&(this._iframe._el.remove(),this._iframe=null,a.iframeHasLoaded(!1))},initCheckout:function(){return this._iframe=new OctobatCheckoutIFrameJS({key:this.octobat_pkey}),this._iframe.appendIframe(),this._button=new OctobatCheckoutButtonJS(a.scriptData("label")),this._button.render()}},void 0===this.OctobatCheckout&&(this.OctobatCheckout=new OctobatCheckoutJS,window.addEventListener("message",function(t){if(t.origin===i)switch(t.data.type){case"closed":"hidden"!==document.querySelector("iframe.octobat-checkout-frame").style.visibility&&OctobatCheckout.iframe().toggle();break;case"error":o("octobat.checkout.error",t.data);break;default:"hidden"!==document.querySelector("iframe.octobat-checkout-frame").style.visibility&&(OctobatCheckout.callback(t.data),OctobatCheckout.iframe().toggle())}})),this.OctobatCheckout.currentScript(e()),a=this.OctobatCheckout.app,document.querySelectorAll(".octobat-checkout-button").length>0&&(OctobatCheckout.configure({octobat_pkey:a.scriptData("octobat-pkey"),callback:function(t){var e,o,a;return a=document.getElementById(t.id).parentNode,o=document.createElement("input"),o.type="hidden",o.name="transactionDetails",o.value=t.transaction,a.appendChild(o),e=a.querySelector(".octobat-checkout-button-el"),e.setAttribute("disabled","disabled"),e.innerHTML="Please wait ...",a.submit()}}),OctobatCheckout.initCheckout())}).call(this);